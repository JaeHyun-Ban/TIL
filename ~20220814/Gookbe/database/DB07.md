# DML(Data Mainpulation Language)

## DML이 실행되는 경우

- 테이블에 새로운 행을 추가할 떄
- 테이블에 있는 기존의 행을 변경할 때
- 테이블로부터 기존의 행을 제거할 때

## 작업의 논리적인 단위 형태인 DML문장의 모음을 **트랜젝션**이라고 한다.\

# INSERT

테이블에 새로운 행을 추가할 때 사용한다.
VALUES절을 가지는 이 문장은 테이블에 한번에 오직 하나의 행만을 추가한다

## 새로운 행 삽입

테이블 구조를 확인한 뒤, 테이블의 순서와 타입에 맞게 모든 열들에 대한 입력 정보를 추가해서 작성해 준다.
모든 **컬럼에 값을 한번에 지정**해 insert할 수도 있고, **컬럼명을 직접 지정**해 원하는 곳만 값을 추가할 수도 있다.

- `ROLLBACK`을 이용해 `INSERT`한 문장을 되돌릴 수 있다.
- insert한 값을 확실하게 추가하고 싶다면 commit을 입력한다

## 다른 테이블로부터 행 복사

- **서브쿼리**로 INSERT 문장을 작성한다
- VALUES 절을 사용하지 않는다.
- **서브쿼리의 열 수와 INSERT절의 열 수가 일치해야한다**

---

# UPDATE

- `UPDATE`는 문장으로 기존의 행을 갱신한다
- 필요하다면 하나 이상의 행을 갱신할 수 있다.
- 문장 마지막에 `WHERE`문으로 컬럼을 지정하지 않으면 모든 컬럼에 값이 변경된다

---

# DELETE

- DELETE문장을 사용해서 테이블로ㅜㅂ터 기존의 행을 제거할 수 있다.
- `WHERE조건절`을 반드시 작성해준다

## 다른 테이블을 이용한 행 삭제

서브쿼리를 이용해서 메인 쿼리의 행을 삭제할 수 있다.

---

# MERGE

하나의 테이블에 매칭되는 조건을 설정, 매칭할 때와 안될 때 각각 다른 실행문을 실행한다.
테이블의 수정, 추가가 빈번한 경우, 따로 저장할 테이블을 만들어 놓고 사용한다
정기적으로 실행할 때 사용된다.

> ex) 매칭이라면 회원정보를 업데이트, 그렇지 않으면 회원정보 생성

```
MERGE INTO table [alias] -- 타겟테이블 a
  USING (targer | view | subquery) [alias] --테이블 b 의 JOIN조건
    ON(join condition) -- a와 b를 JOIN
  WWEH MATCHED THEN --매칭이 된다면
    UPDATE SET a.[--] = b.[--] -- a에 없데이트를 진행
  WHEN NOT MATCHED THEN --매칭이 안된다면
    INSERT (column_list) VALUES (value_lists) --새롭게 INSERT해준다
```

---

# CTAS(Create Table AS TABLES)

테이블 생성시에도 서브쿼리 문장을 사용할 수 있다.
사본테이블 생성에 사용.
